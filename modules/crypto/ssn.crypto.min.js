"use strict";if(typeof ssn=="undefined")var ssn={};ssn.crypto={generate_Key:function(e,t){var n=new RSA;if(typeof t!="function"){var r=n.generate(ssn.config.keyLength,"10001"),i=new ssn.crypto.privateKey(r,e),s=new ssn.crypto.publicKey(r);return{privateKey:i,publicKey:s}}Modernizr.webworkers?ssn.crypto.waitForReady(function(){n.generateAsync(ssn.config.keyLength,"10001",function(n){var r=new ssn.crypto.privateKey(n,e),i=new ssn.crypto.publicKey(n);t(r,i)})}):setTimeout(function(){ssn.crypto.waitForReady(function(){var n=ssn.crypto.generate_Key(e);t(n.privateKey,n.publicKey)})},1)},encryptText:function(e,t,n){if(typeof n!="function"){var r=0,i={};if(typeof e=="object"&&e){var s;e instanceof ssn.crypto.sessionKey?s=e:s=new ssn.crypto.sessionKey;var o=s.encryptText(t);if(e instanceof Array)for(r=0;r<e.length;r+=1)i[e[r].id]=s.getEncrypted(e[r]);else e instanceof ssn.crypto.publicKey&&(i[e.id]=s.getEncrypted(e));return e instanceof ssn.crypto.sessionKey?o:{sessionKeys:i,EM:o}}return!1}setTimeout(function(){ssn.crypto.waitForReady(function(){n(ssn.crypto.encryptText(e,t))})},1)},decryptText:function(e,t,n,r){if(typeof r!="function")return n instanceof ssn.crypto.sessionKey||(n=new ssn.crypto.sessionKey(n)),n.decryptKey(e)?typeof t=="object"?n.decryptText(t.ct,t.iv):n.decryptText(t):!1;setTimeout(function(){r(ssn.crypto.decryptText(e,t,n))},1)},signText:function(e,t,n){if(typeof n!="function"){var r=sjcl.codec.hex.fromBits(sjcl.hash.sha256.hash(t));return e.sign(r).toString(16)}ssn.crypto.waitForReady(function(){n(ssn.crypto.signText(e,t))})},verifyText:function(e,t,n,r){if(typeof r!="function"){n=new BigInteger(n,16);var i=sjcl.codec.hex.fromBits(sjcl.hash.sha256.hash(t)),s=new RSA;return s.verifyPSS(i,n,e.ee,e.n)}setTimeout(function(){r(ssn.crypto.verifyText(e,t,n))},1)},waitForReady:function(e){sjcl.random.isReady()?e():(ssn.logger.log("Not yet ready!"),ssn.display.showNotReadyWarning(),sjcl.random.addEventListener("seeded",function(){ssn.display.hideNotReadyWarning(),ssn.logger.log("Lets go!"),e()}))},r0:function(e){while(e.substr(0,1)==="0")e=e.substr(1);return e},encryptSessionKey:function(e,t,n,r){if(typeof r!="function"){var i=new Date;t instanceof ssn.crypto.sessionKey||(t=new ssn.crypto.sessionKey(t));if(t.decryptKey(n)){ssn.logger.log("SKey Decrypted:"+((new Date).getTime()-i));var s=t.getEncrypted(e);return ssn.logger.log("SKey ReEncrypted:"+((new Date).getTime()-i)),s}return!1}setTimeout(function(){ssn.crypto.waitForReady(function(){r(ssn.crypto.encryptSessionKey(e,t,n))})},1)},sha256:function(e){return sjcl.codec.hex.fromBits(sjcl.hash.sha256.hash(e))}},"use strict";if(typeof ssn=="undefined")var ssn={};typeof ssn.crypto=="undefined"&&(ssn.crypto={}),ssn.crypto.privateKey=function(e,t){this.ee=null,this.n=null,this.id=null;var n=new RSA,r=null,i=null,s=null,o=null,u=function(e){return n.decryptcrt(e,r,i,s,o)},a=function(e,t){return n.decryptOAEP(e,r,i,s,o,this.n,t)},f=function(e){return n.signPSS(e,r,i,s,o,this.n)},l=function(e){this.ee=e.ee,this.n=e.n,r=e.d,i=e.p,s=e.q,o=e.u},c=function(){var e={d:r.toString(16),p:i.toString(16),q:s.toString(16),u:o.toString(16)},n='{"ee":"'+this.ee.toString(16)+'",'+'"n":"'+this.n.toString(16)+'",'+'"id":"'+this.id+'",'+'"priv":'+sjcl.json.encrypt(t,sjcl.json.encode(e))+"}";return n},h=function(e){var n=jQuery.parseJSON(e);if(n===null)return!1;this.ee=new BigInteger(n.ee,16),this.n=new BigInteger(n.n,16),this.id=n.id;var u=$.toJSON(n.priv),a=sjcl.json.decrypt(t,u),f=jQuery.parseJSON(a);return r=new BigInteger(f.d,16),i=new BigInteger(f.p,16),s=new BigInteger(f.q,16),o=new BigInteger(f.u,16),!0},p=function(e,n){return e===t?(t=n,!0):!1};this.setPassword=p,this.readEncrypted=h,this.getEncrypted=c,this.getJSON=c,this.readFromRSA=l,this.sign=f,this.decryptOAEP=a,this.decrypt=u;if(e!==null)try{this.readEncrypted(e)||this.readFromRSA(e)}catch(d){throw ssn.logger.log(d),d}},"use strict";if(typeof ssn=="undefined")var ssn={};typeof ssn.crypto=="undefined"&&(ssn.crypto={}),ssn.crypto.publicKey=function(e){this.ee=null,this.n=null,this.id=null;var t=function(){var e='{"ee":"'+this.ee.toString(16)+'",'+'"n":"'+this.n.toString(16)+'",'+'"id":"'+this.id+'"'+"}";return e},n=function(e){var t;return typeof e!="object"?t=jQuery.parseJSON(e):t=e,t===null||typeof t.ee!="string"||typeof t.n!="string"?!1:(this.ee=new BigInteger(t.ee,16),this.n=new BigInteger(t.n,16),this.id=t.id,!0)},r=function(e){this.ee=e.ee,this.n=e.n};this.readFromRSA=r,this.getJSON=t,this.readFromJSON=n;if(e!==null)try{this.readFromJSON(e)||this.readFromRSA(e)}catch(i){ssn.logger.log(i)}},"use strict";if(typeof ssn=="undefined")var ssn={};typeof ssn.crypto=="undefined"&&(ssn.crypto={}),ssn.crypto.sessionKey=function(e){var t="",n="",r=!1;if(typeof e!="undefined")t=e;else try{n=sjcl.codec.hex.fromBits(sjcl.random.randomWords(8,ssn.config.paranoia),0);while((new BigInteger(n,16)).toString(16)!==n)ssn.logger.log("Session Key invalid!"),n=sjcl.codec.hex.fromBits(sjcl.random.randomWords(8,ssn.config.paranoia),0);r=!0}catch(i){throw ssn.logger.log(i),i}var s=function(e){if(!r){var i=new BigInteger(t,16);if(e instanceof ssn.crypto.privateKey){var s=e.decryptOAEP(i,"Socialize");if(s!==!1){r=!0,n=s.toString(16);while(n.length<64)n="0"+n;return!0}return!1}if(e instanceof ssn.crypto.sessionKey)try{n=e.decryptText(t),r=!0;while(n.length<64)n="0"+n;return!0}catch(o){return!1}throw new ssn.exception.needPrivateKey("Session Key Decryption Failed.")}return!0},o=function(e){if(!r)return!1;if(e instanceof ssn.crypto.publicKey||e instanceof ssn.crypto.privateKey){var t=new RSA,i=t.encryptOAEP(new BigInteger(n,16),e.ee,e.n,"Socialize").toString(16);return i}return e instanceof ssn.crypto.sessionKey?e.encryptText(n):!1},u=function(e,t){return r?typeof t=="undefined"?sjcl.decrypt(sjcl.codec.hex.toBits(n),e):sjcl.decrypt(sjcl.codec.hex.toBits(n),e,{iv:t}):!1},a=function(e,t){if(r){var i;return typeof t=="undefined"?i=sjcl.encrypt(sjcl.codec.hex.toBits(n),e):i=sjcl.encrypt(sjcl.codec.hex.toBits(n),e,{iv:t}),i}return!1};this.decryptKey=s,this.getEncrypted=o,this.encryptText=a,this.decryptText=u}